#ifndef INC_RGB_H_
#define INC_RGB_H_

// PRIVATE INCLUDE ================================================================================

#include <WS2812B.h>

// PRIVATE FUNCTION PROTOTYPE =====================================================================

uint32_t LERP(uint32_t start, uint32_t end, float t);
void RGB_Rainbow(void);

// USER CODE ======================================================================================

void RGB_Rainbow(void) {
	static uint32_t previousTime = 0;
	static uint8_t hue = 0;

	uint32_t currentTime = HAL_GetTick();
	uint32_t elapsedTime = currentTime - previousTime;

	// Change hue every 100 milliseconds
	if (elapsedTime >= 100) {
		previousTime = currentTime;

		// Update hue
		hue++;
		if (hue > 255) {
			hue = 0;
		}

		// Calculate color gradient
		uint32_t colorStart = hue;
		uint32_t colorEnd = (hue + 85) % 255;

		// Set LED colors based on color gradient
		for (int i = 0; i < MAX_LED; i++) {
			float t = (float) i / MAX_LED;

			// Calculate intermediate colors using multiple LERP calculations
			uint32_t color1 = LERP(colorStart, colorEnd, t);
			uint32_t color2 = LERP(colorStart, colorEnd, t + 0.5f);
			uint32_t color = (color1 + color2) / 2;

			Set_LED(i, color, 255 - color, 0);
		}

		// Send LED data to update colors
		WS2812_Send();
		Set_Brightness(5);
	}
}

void Set_LED(int LEDnum, int Red, int Green, int Blue) {
	// Code to set LED color at the specified LEDnum
	// Replace with your implementation
}

void WS2812_Send(void) {
	// Code to send LED data using PWM
	// Replace with your implementation
}

uint32_t LERP(uint32_t start, uint32_t end, float t) {
	return (uint32_t) ((1 - t) * start + t * end);
}

#endif /* INC_RGB_H_ */
